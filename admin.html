<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>Admin Permohonan</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial;
  background:#f2f2f2;
  padding:20px;
}
.box {
  background:white;
  padding:20px;
  border-radius:10px;
}
table {
  width:100%;
  border-collapse:collapse;
  margin-top:10px;
}
th, td {
  border:1px solid #ccc;
  padding:8px;
}
th { background:#eee; }
</style>
</head>

<body>
<div class="box">
  <h2>Admin â€“ Senarai Permohonan</h2>

  <select id="jenis">
    <option value="alat_tulis">Alat Tulis</option>
    <option value="kenderaan">Kenderaan</option>
    <option value="projektor">Projektor</option>
    <option value="kertas_a4">Kertas A4</option>
  </select>

  <button onclick="loadData()">Load</button>

  <table id="table"></table>
</div>

<script>
/* ================== URL API GET ================== */
const RESPONSE_API = {
  alat_tulis: "https://script.google.com/macros/s/AKfycby4CIOskjouhtpHTphx6QbWnXRqM2FH_yUk3EYvDecBDOzdctgTP6SEKEIR7zzW2edf/exec",
  kenderaan: "https://script.google.com/macros/s/AKfycbx89YM8VbwIor0p0UcOgw8Q7l7AueTSeoco2WP2L-BRnWmLiUZfA4VECRa_4cCgUxnekA/exec",
  projektor: "https://script.google.com/macros/s/AKfycbxVj_jNHUK8K1hwhgzjO6sugFMOZNIknHVwWS6OW8x5ETcjyYPwS-EDK3xh-SND-pVh/exec",
  kertas_a4: "https://script.google.com/macros/s/AKfycbzXvbC_j34ahdESa2MyP7e6QN0p_Jdy_o2Kxt-ZUPCOqZOw4Csf7py6ERDO10SQlt0L/exec"
};

async function loadData() {
  const type = jenis.value;
  const res = await fetch(RESPONSE_API[type]);
  const data = await res.json();

  table.innerHTML = "";
  if (!data || data.length === 0) return;

  table.innerHTML += `
    <tr>${Object.keys(data[0]).map(h => `<th>${h}</th>`).join("")}</tr>
  `;

  data.forEach(row => {
    table.innerHTML += `
      <tr>${Object.values(row).map(v => `<td>${v}</td>`).join("")}</tr>
    `;
  });
}
</script>
</body>
</html>
